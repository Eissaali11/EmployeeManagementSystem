{
	"info": {
		"_postman_id": "nuzum-api-collection-2024",
		"name": "نُظم - نظام إدارة الموظفين والمركبات API",
		"description": "مجموعة كاملة لاختبار جميع APIs في نظام نُظم\n\nالميزات:\n- إدارة الموظفين الكاملة\n- إدارة المركبات\n- نظام الحضور والغياب\n- إدارة الرواتب\n- التقارير الشاملة\n- البحث المتقدم\n- المصادقة المتقدمة\n\nقم بتعيين المتغيرات البيئية:\n- base_url: http://localhost:5000\n- auth_token: سيتم تعيينه تلقائياً بعد تسجيل الدخول",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "🔐 المصادقة والترخيص",
			"item": [
				{
					"name": "فحص صحة API",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/health",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"health"
							]
						},
						"description": "فحص حالة API والتأكد من أنه يعمل بشكل طبيعي"
					},
					"response": []
				},
				{
					"name": "معلومات API",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/info",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"info"
							]
						},
						"description": "الحصول على معلومات API وجميع المسارات المتاحة"
					},
					"response": []
				},
				{
					"name": "تسجيل دخول المستخدم",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.to.have.status(200)) {",
									"    var response = pm.response.json();",
									"    if (response.success && response.data && response.data.token) {",
									"        pm.environment.set('auth_token', response.data.token);",
									"        pm.environment.set('user_id', response.data.user.id);",
									"        pm.environment.set('company_id', response.data.user.company_id);",
									"        console.log('✅ تم حفظ Auth Token بنجاح');",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"admin@nuzum.sa\",\n  \"password\": \"admin123\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/auth/login",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"auth",
								"login"
							]
						},
						"description": "تسجيل دخول المستخدم والحصول على JWT Token"
					},
					"response": []
				},
				{
					"name": "تسجيل دخول الموظف",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.to.have.status(200)) {",
									"    var response = pm.response.json();",
									"    if (response.success && response.data && response.data.token) {",
									"        pm.environment.set('employee_token', response.data.token);",
									"        pm.environment.set('employee_id', response.data.employee.id);",
									"        console.log('✅ تم حفظ Employee Token بنجاح');",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"employee_id\": \"4298\",\n  \"national_id\": \"2489682019\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/auth/employee-login",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"auth",
								"employee-login"
							]
						},
						"description": "تسجيل دخول الموظف باستخدام رقم الموظف والهوية الوطنية"
					},
					"response": []
				}
			],
			"description": "مجموعة APIs للمصادقة وتسجيل الدخول"
		},
		{
			"name": "📊 لوحة المعلومات",
			"item": [
				{
					"name": "إحصائيات لوحة المعلومات",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/dashboard/stats",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"dashboard",
								"stats"
							]
						},
						"description": "الحصول على إحصائيات شاملة للنظام:\n- عدد الموظفين\n- عدد المركبات\n- عدد الأقسام\n- إحصائيات الحضور اليومي"
					},
					"response": []
				}
			],
			"description": "APIs خاصة بلوحة المعلومات والإحصائيات العامة"
		},
		{
			"name": "👥 إدارة الموظفين",
			"item": [
				{
					"name": "قائمة الموظفين مع Pagination",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/employees?page=1&per_page=20&sort_by=name&sort_order=asc",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"employees"
							],
							"query": [
								{
									"key": "page",
									"value": "1",
									"description": "رقم الصفحة"
								},
								{
									"key": "per_page",
									"value": "20",
									"description": "عدد العناصر في الصفحة"
								},
								{
									"key": "sort_by",
									"value": "name",
									"description": "الترتيب حسب (name, employee_id, created_at)"
								},
								{
									"key": "sort_order",
									"value": "asc",
									"description": "اتجاه الترتيب (asc, desc)"
								}
							]
						},
						"description": "جلب قائمة الموظفين مع إمكانية التصفح والترتيب"
					},
					"response": []
				},
				{
					"name": "البحث في الموظفين",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/employees?search=محمد&status=active",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"employees"
							],
							"query": [
								{
									"key": "search",
									"value": "محمد",
									"description": "البحث في الاسم، رقم الموظف، أو البريد الإلكتروني"
								},
								{
									"key": "status",
									"value": "active",
									"description": "تصفية حسب الحالة (active, inactive)"
								}
							]
						},
						"description": "البحث في الموظفين بالاسم أو رقم الموظف"
					},
					"response": []
				},
				{
					"name": "تفاصيل موظف محدد",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/employees/179",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"employees",
								"179"
							]
						},
						"description": "جلب تفاصيل موظف محدد مع البيانات المرتبطة"
					},
					"response": []
				},
				{
					"name": "إضافة موظف جديد",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.to.have.status(201)) {",
									"    var response = pm.response.json();",
									"    if (response.success && response.data && response.data.id) {",
									"        pm.environment.set('new_employee_id', response.data.id);",
									"        console.log('✅ تم إنشاء موظف جديد بـ ID: ' + response.data.id);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"أحمد محمد التجريبي\",\n  \"employee_id\": \"9999\",\n  \"national_id\": \"1234567890\",\n  \"email\": \"ahmed.test@example.com\",\n  \"phone\": \"0501234567\",\n  \"department_id\": 1,\n  \"job_title\": \"مطور\",\n  \"basic_salary\": 8000,\n  \"status\": \"active\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/employees",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"employees"
							]
						},
						"description": "إضافة موظف جديد للنظام"
					},
					"response": []
				},
				{
					"name": "تحديث بيانات موظف",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"أحمد محمد المحدث\",\n  \"job_title\": \"مطور أول\",\n  \"basic_salary\": 9000,\n  \"status\": \"active\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/employees/{{new_employee_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"employees",
								"{{new_employee_id}}"
							]
						},
						"description": "تحديث بيانات موظف موجود"
					},
					"response": []
				},
				{
					"name": "حذف موظف",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/employees/{{new_employee_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"employees",
								"{{new_employee_id}}"
							]
						},
						"description": "حذف موظف من النظام (يتم تعطيله وليس حذفه نهائياً)"
					},
					"response": []
				}
			],
			"description": "APIs شاملة لإدارة الموظفين - إضافة، تعديل، حذف، بحث"
		},
		{
			"name": "🚗 إدارة المركبات",
			"item": [
				{
					"name": "قائمة المركبات",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/vehicles?page=1&per_page=20",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"vehicles"
							],
							"query": [
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "per_page",
									"value": "20"
								}
							]
						},
						"description": "جلب قائمة المركبات مع Pagination"
					},
					"response": []
				},
				{
					"name": "البحث في المركبات",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/vehicles?search=١٢٣&status=active",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"vehicles"
							],
							"query": [
								{
									"key": "search",
									"value": "١٢٣",
									"description": "البحث في رقم اللوحة، الماركة، أو الموديل"
								},
								{
									"key": "status",
									"value": "active",
									"description": "تصفية حسب الحالة"
								}
							]
						},
						"description": "البحث في المركبات برقم اللوحة أو الماركة"
					},
					"response": []
				},
				{
					"name": "تفاصيل مركبة محددة",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/vehicles/14",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"vehicles",
								"14"
							]
						},
						"description": "جلب تفاصيل مركبة محددة مع سجلات التسليم والورشة"
					},
					"response": []
				}
			],
			"description": "APIs لإدارة المركبات وسجلات التسليم والورشة"
		},
		{
			"name": "🏢 إدارة الأقسام",
			"item": [
				{
					"name": "قائمة الأقسام",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/departments",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"departments"
							]
						},
						"description": "جلب قائمة الأقسام مع عدد الموظفين ومعلومات المدير"
					},
					"response": []
				}
			],
			"description": "APIs لإدارة الأقسام والهيكل التنظيمي"
		},
		{
			"name": "⏰ إدارة الحضور",
			"item": [
				{
					"name": "قائمة سجلات الحضور",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/attendance?page=1&per_page=20",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"attendance"
							],
							"query": [
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "per_page",
									"value": "20"
								}
							]
						},
						"description": "جلب سجلات الحضور مع إمكانية التصفية"
					},
					"response": []
				},
				{
					"name": "حضور موظف محدد",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/attendance?employee_id=179&date_from=2024-01-01&date_to=2024-01-31",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"attendance"
							],
							"query": [
								{
									"key": "employee_id",
									"value": "179",
									"description": "ID الموظف"
								},
								{
									"key": "date_from",
									"value": "2024-01-01",
									"description": "تاريخ البداية"
								},
								{
									"key": "date_to",
									"value": "2024-01-31",
									"description": "تاريخ النهاية"
								}
							]
						},
						"description": "جلب سجلات حضور موظف محدد في فترة معينة"
					},
					"response": []
				},
				{
					"name": "تسجيل حضور جديد",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"employee_id\": 179,\n  \"date\": \"2024-07-01\",\n  \"status\": \"present\",\n  \"check_in_time\": \"08:00\",\n  \"check_out_time\": \"17:00\",\n  \"notes\": \"حضور عادي من API\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/attendance",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"attendance"
							]
						},
						"description": "تسجيل حضور جديد لموظف\n\nالحالات المتاحة:\n- present: حاضر\n- absent: غائب\n- late: متأخر\n- vacation: إجازة\n- sick: إجازة مرضية"
					},
					"response": []
				}
			],
			"description": "APIs لإدارة حضور وغياب الموظفين"
		},
		{
			"name": "💰 إدارة الرواتب",
			"item": [
				{
					"name": "رواتب موظف محدد",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/employees/179/salaries?page=1&per_page=12",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"employees",
								"179",
								"salaries"
							],
							"query": [
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "per_page",
									"value": "12"
								}
							]
						},
						"description": "جلب سجلات رواتب موظف محدد"
					},
					"response": []
				}
			],
			"description": "APIs لإدارة رواتب ومكافآت الموظفين"
		},
		{
			"name": "📊 التقارير والإحصائيات",
			"item": [
				{
					"name": "تقرير ملخص الموظفين",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/reports/employees/summary",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"reports",
								"employees",
								"summary"
							]
						},
						"description": "تقرير شامل عن إحصائيات الموظفين والتوزيع حسب الأقسام"
					},
					"response": []
				},
				{
					"name": "تقرير الحضور الشهري",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/reports/attendance/monthly?year=2024&month=7",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"reports",
								"attendance",
								"monthly"
							],
							"query": [
								{
									"key": "year",
									"value": "2024",
									"description": "السنة"
								},
								{
									"key": "month",
									"value": "7",
									"description": "الشهر (1-12)"
								}
							]
						},
						"description": "تقرير تفصيلي عن حضور الموظفين في شهر محدد"
					},
					"response": []
				}
			],
			"description": "APIs للتقارير والإحصائيات المختلفة"
		},
		{
			"name": "🔍 البحث المتقدم",
			"item": [
				{
					"name": "البحث الشامل في النظام",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"query\": \"محمد\",\n  \"search_in\": [\"employees\", \"vehicles\"]\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/search",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"search"
							]
						},
						"description": "البحث المتقدم في جميع بيانات النظام\n\nخيارات البحث:\n- employees: الموظفين\n- vehicles: المركبات"
					},
					"response": []
				}
			],
			"description": "APIs للبحث المتقدم في جميع بيانات النظام"
		},
		{
			"name": "🔔 الإشعارات والتنبيهات",
			"item": [
				{
					"name": "قائمة الإشعارات",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/notifications",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"notifications"
							]
						},
						"description": "جلب قائمة الإشعارات والتنبيهات للمستخدم"
					},
					"response": []
				}
			],
			"description": "APIs لإدارة الإشعارات والتنبيهات"
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// التحقق من نجاح الطلب",
					"pm.test(\"Status code is success\", function () {",
					"    pm.expect(pm.response.code).to.be.oneOf([200, 201]);",
					"});",
					"",
					"// التحقق من وجود response body",
					"pm.test(\"Response has body\", function () {",
					"    pm.response.to.have.body;",
					"});",
					"",
					"// التحقق من صيغة JSON",
					"pm.test(\"Response is JSON\", function () {",
					"    pm.response.to.be.json;",
					"});",
					"",
					"// التحقق من وجود success field",
					"if (pm.response.code === 200 || pm.response.code === 201) {",
					"    pm.test(\"Response has success field\", function () {",
					"        var jsonData = pm.response.json();",
					"        pm.expect(jsonData).to.have.property('success');",
					"    });",
					"}"
				]
			}
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:5000",
			"type": "string"
		},
		{
			"key": "auth_token",
			"value": "",
			"type": "string"
		},
		{
			"key": "employee_token",
			"value": "",
			"type": "string"
		},
		{
			"key": "user_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "company_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "employee_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "new_employee_id",
			"value": "",
			"type": "string"
		}
	]
}