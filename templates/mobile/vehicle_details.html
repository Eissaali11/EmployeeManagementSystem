{% extends "mobile/base_layout.html" %}

{% block title %}تفاصيل السيارة - {{ vehicle.make }} {{ vehicle.model }}{% endblock %}

{% block content %}
<style>
    /* تفاصيل السيارة - نسخة الجوال */
    .vehicle-detail-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 20px;
        border-radius: 16px;
        margin: 15px;
        color: white;
        text-align: center;
        position: relative;
    }

    .vehicle-detail-icon {
        width: 60px;
        height: 60px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 16px auto;
        font-size: 24px;
        color: white;
    }

    .vehicle-detail-title {
        font-size: 22px;
        font-weight: 700;
        margin-bottom: 8px;
    }

    .vehicle-detail-subtitle {
        font-size: 14px;
        opacity: 0.9;
    }

    .vehicle-status-badge {
        position: absolute;
        top: 20px;
        right: 20px;
        padding: 6px 12px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 600;
        background: rgba(255, 255, 255, 0.2);
        color: white;
    }

    .info-section {
        background: white;
        border-radius: 16px;
        padding: 20px;
        margin: 15px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .info-section-title {
        font-size: 16px;
        font-weight: 600;
        color: #1a1a1a;
        margin-bottom: 16px;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .info-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 0;
        border-bottom: 1px solid #f0f0f0;
    }

    .info-row:last-child {
        border-bottom: none;
    }

    .info-label {
        font-size: 14px;
        color: #6c757d;
        font-weight: 500;
    }

    .info-value {
        font-size: 14px;
        color: #1a1a1a;
        font-weight: 600;
        text-align: right;
    }

    .vehicle-plate-display {
        display: grid;
        grid-template-columns: 2fr 1fr;
        border: 3px solid #333;
        border-radius: 8px;
        overflow: hidden;
        background: white;
        width: fit-content;
        margin: 0 auto;
    }

    .plate-number-display {
        background: white;
        color: #333;
        font-family: 'Arial', sans-serif;
        font-weight: bold;
        font-size: 16px;
        padding: 12px 16px;
        text-align: center;
        border-right: 2px solid #333;
    }

    .plate-region-display {
        background: white;
        color: #333;
        font-family: 'Arial', sans-serif;
        font-weight: bold;
        font-size: 14px;
        padding: 12px 8px;
        text-align: center;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .empty-state {
        text-align: center;
        padding: 40px 20px;
        color: #6c757d;
    }

    .empty-state i {
        font-size: 48px;
        color: #e9ecef;
        margin-bottom: 16px;
    }

    .document-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px;
        background: #f8f9fa;
        border-radius: 8px;
        margin-bottom: 8px;
    }

    .document-icon {
        width: 40px;
        height: 40px;
        background: #4A90E2;
        color: white;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 16px;
    }

    .document-info {
        flex: 1;
    }

    .document-name {
        font-size: 14px;
        font-weight: 600;
        color: #1a1a1a;
        margin-bottom: 4px;
    }

    .document-date {
        font-size: 12px;
        color: #6c757d;
    }

    .back-button {
        margin: 15px;
        background: #6c757d;
        color: white;
        border: none;
        border-radius: 8px;
        padding: 12px 20px;
        font-size: 14px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
    }
</style>

<!-- زر العودة -->
<button class="back-button" onclick="window.location.href='/mobile/vehicles'">
    <i class="fas fa-arrow-right"></i>
    العودة للسيارات
</button>

<!-- رأس تفاصيل السيارة -->
<div class="vehicle-detail-header">
    <div class="vehicle-status-badge">
        {% if vehicle.status == 'available' %}متاحة
        {% elif vehicle.status == 'rented' %}مؤجرة
        {% elif vehicle.status == 'maintenance' %}صيانة
        {% elif vehicle.status == 'in_workshop' %}ورشة
        {% else %}متاحة
        {% endif %}
    </div>
    
    <div class="vehicle-detail-icon">
        <i class="fas fa-truck"></i>
    </div>
    
    <div class="vehicle-detail-title">
        {{ vehicle.make }} {{ vehicle.model }}
    </div>
    
    <div class="vehicle-detail-subtitle">
        {% if vehicle.year %}موديل {{ vehicle.year }}{% endif %}
    </div>
</div>

<!-- معلومات أساسية -->
<div class="info-section">
    <div class="info-section-title">
        <i class="fas fa-info-circle"></i>
        المعلومات الأساسية
    </div>
    
    {% if vehicle.plate_number %}
    <div class="info-row">
        <span class="info-label">رقم اللوحة</span>
        <div class="info-value">
            <div class="vehicle-plate-display">
                <div class="plate-number-display">{{ vehicle.plate_number }}</div>
                <div class="plate-region-display">KH</div>
            </div>
        </div>
    </div>
    {% endif %}
    
    {% if vehicle.make %}
    <div class="info-row">
        <span class="info-label">الماركة</span>
        <span class="info-value">{{ vehicle.make }}</span>
    </div>
    {% endif %}
    
    {% if vehicle.model %}
    <div class="info-row">
        <span class="info-label">الموديل</span>
        <span class="info-value">{{ vehicle.model }}</span>
    </div>
    {% endif %}
    
    {% if vehicle.year %}
    <div class="info-row">
        <span class="info-label">سنة الصنع</span>
        <span class="info-value">{{ vehicle.year }}</span>
    </div>
    {% endif %}
    
    {% if vehicle.color %}
    <div class="info-row">
        <span class="info-label">اللون</span>
        <span class="info-value">{{ vehicle.color }}</span>
    </div>
    {% endif %}
    
    {% if vehicle.driver_name %}
    <div class="info-row">
        <span class="info-label">السائق الحالي</span>
        <span class="info-value">{{ vehicle.driver_name }}</span>
    </div>
    {% endif %}
</div>

<!-- إحصائيات إضافية -->
{% if maintenance_records or workshop_records %}
<div class="info-section">
    <div class="info-section-title">
        <i class="fas fa-wrench"></i>
        سجلات الصيانة والورشة
    </div>
    
    {% if maintenance_records %}
    <div class="info-row">
        <span class="info-label">عدد سجلات الصيانة</span>
        <span class="info-value">{{ maintenance_records|length }}</span>
    </div>
    {% endif %}
    
    {% if workshop_records %}
    <div class="info-row">
        <span class="info-label">عدد سجلات الورشة</span>
        <span class="info-value">{{ workshop_records|length }}</span>
    </div>
    {% endif %}
    
    {% if total_maintenance_cost %}
    <div class="info-row">
        <span class="info-label">إجمالي تكلفة الإصلاحات</span>
        <span class="info-value">{{ "{:,.0f}".format(total_maintenance_cost) }} ريال</span>
    </div>
    {% endif %}
</div>
{% endif %}

<!-- التسليمات -->
{% if handover_records %}
<div class="info-section">
    <div class="info-section-title">
        <i class="fas fa-exchange-alt"></i>
        آخر التسليمات ({{ handover_records|length }})
    </div>
    
    {% for handover in handover_records[:5] %}
    <div class="info-row">
        <span class="info-label">
            {% if handover.type == 'handover' %}
                تسليم إلى {{ handover.driver_name }}
            {% else %}
                استلام من {{ handover.driver_name }}
            {% endif %}
        </span>
        <span class="info-value">{{ handover.handover_date.strftime('%Y-%m-%d') if handover.handover_date else 'غير محدد' }}</span>
    </div>
    {% endfor %}
</div>
{% endif %}

<!-- رسالة عدم وجود بيانات إضافية -->
{% if not maintenance_records and not workshop_records and not handover_records %}
<div class="info-section">
    <div class="empty-state">
        <i class="fas fa-folder-open"></i>
        <div>لا توجد سجلات صيانة أو تسليمات مسجلة</div>
    </div>
</div>
{% endif %}

{% endblock %}