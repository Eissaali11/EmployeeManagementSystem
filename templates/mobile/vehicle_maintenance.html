{% extends 'mobile/layout.html' %}

{% block title %}صيانة السيارات{% endblock %}
{% block header_title %}صيانة السيارات{% endblock %}

{% block content %}
<div class="mobile-section">
  <div class="mobile-section-header">
    <h2 class="mobile-section-title">
      <i class="fas fa-tools"></i>
      صيانة السيارات
    </h2>
    <a href="{{ url_for('mobile.vehicles') }}" class="mobile-btn mobile-btn-secondary">
      <i class="fas fa-arrow-right"></i>
      عودة
    </a>
  </div>
  
  <!-- إحصائيات سريعة -->
  <div class="mobile-summary-cards">
    <div class="mobile-summary-card primary">
      <div class="mobile-summary-icon">
        <i class="fas fa-wrench"></i>
      </div>
      <div class="mobile-summary-value">5</div>
      <div class="mobile-summary-label">قيد التنفيذ</div>
    </div>
    
    <div class="mobile-summary-card success">
      <div class="mobile-summary-icon">
        <i class="fas fa-check-circle"></i>
      </div>
      <div class="mobile-summary-value">23</div>
      <div class="mobile-summary-label">منجزة</div>
    </div>
    
    <div class="mobile-summary-card warning">
      <div class="mobile-summary-icon">
        <i class="fas fa-exclamation-triangle"></i>
      </div>
      <div class="mobile-summary-value">3</div>
      <div class="mobile-summary-label">متأخرة</div>
    </div>
    
    <div class="mobile-summary-card danger">
      <div class="mobile-summary-icon">
        <i class="fas fa-calendar-day"></i>
      </div>
      <div class="mobile-summary-value">2</div>
      <div class="mobile-summary-label">اليوم</div>
    </div>
  </div>

  <!-- قائمة الصيانة -->
  <div class="mobile-card">
    <div class="mobile-card-header">
      <div class="mobile-card-title">
        <i class="fas fa-list"></i>
        سجل الصيانة
      </div>
      <div class="mobile-card-actions">
        <button class="mobile-btn-icon" onclick="toggleFilters()">
          <i class="fas fa-filter"></i>
        </button>
      </div>
    </div>
    
    <!-- فلاتر البحث (مخفية افتراضياً) -->
    <div class="mobile-card-body" id="filtersSection" style="display: none;">
      <div class="mobile-form-group">
        <label class="mobile-form-label">السيارة</label>
        <select class="mobile-form-select">
          <option value="">جميع السيارات</option>
          <option value="1">تويوتا كامري</option>
          <option value="2">هونداي سوناتا</option>
          <option value="3">نيسان باترول</option>
        </select>
      </div>
      
      <div class="mobile-form-group">
        <label class="mobile-form-label">نوع الصيانة</label>
        <select class="mobile-form-select">
          <option value="">جميع الأنواع</option>
          <option value="regular">صيانة دورية</option>
          <option value="repair">إصلاح عطل</option>
          <option value="inspection">فحص</option>
          <option value="other">أخرى</option>
        </select>
      </div>
      
      <div class="mobile-form-group">
        <label class="mobile-form-label">الحالة</label>
        <select class="mobile-form-select">
          <option value="">جميع الحالات</option>
          <option value="pending">قيد الانتظار</option>
          <option value="in_progress">قيد التنفيذ</option>
          <option value="completed">منجزة</option>
          <option value="canceled">ملغية</option>
        </select>
      </div>
      
      <div class="mobile-form-actions">
        <button class="mobile-btn mobile-btn-primary" onclick="applyFilters()">
          <i class="fas fa-search"></i>
          تطبيق الفلتر
        </button>
      </div>
    </div>
    
    <div class="mobile-maintenance-list">
      <!-- مهمة صيانة -->
      <div class="mobile-maintenance-item active">
        <div class="mobile-maintenance-status ongoing">قيد التنفيذ</div>
        <div class="mobile-maintenance-content">
          <div class="mobile-maintenance-title">تغيير زيت المحرك وفلتر</div>
          <div class="mobile-maintenance-vehicle">تويوتا كامري - أ ب ج ١٢٣٤</div>
          <div class="mobile-maintenance-meta">
            <span><i class="fas fa-calendar"></i> ١٥ أبريل ٢٠٢٥</span>
            <span><i class="fas fa-user"></i> فني: أحمد محمد</span>
          </div>
        </div>
        <button class="mobile-btn-icon mobile-maintenance-more" onclick="viewMaintenance(1)">
          <i class="fas fa-chevron-left"></i>
        </button>
      </div>
      
      <!-- مهمة صيانة -->
      <div class="mobile-maintenance-item">
        <div class="mobile-maintenance-status late">متأخرة</div>
        <div class="mobile-maintenance-content">
          <div class="mobile-maintenance-title">فحص منظومة التعليق</div>
          <div class="mobile-maintenance-vehicle">هونداي سوناتا - س ع د ٥٦٧٨</div>
          <div class="mobile-maintenance-meta">
            <span><i class="fas fa-calendar"></i> ١٠ أبريل ٢٠٢٥</span>
            <span><i class="fas fa-user"></i> فني: ماجد سعيد</span>
          </div>
        </div>
        <button class="mobile-btn-icon mobile-maintenance-more" onclick="viewMaintenance(2)">
          <i class="fas fa-chevron-left"></i>
        </button>
      </div>
      
      <!-- مهمة صيانة -->
      <div class="mobile-maintenance-item">
        <div class="mobile-maintenance-status scheduled">مجدولة</div>
        <div class="mobile-maintenance-content">
          <div class="mobile-maintenance-title">تغيير إطارات</div>
          <div class="mobile-maintenance-vehicle">نيسان باترول - ك و ي ٩٨٧٦</div>
          <div class="mobile-maintenance-meta">
            <span><i class="fas fa-calendar"></i> ٢٠ أبريل ٢٠٢٥</span>
            <span><i class="fas fa-user"></i> فني: محمد سامي</span>
          </div>
        </div>
        <button class="mobile-btn-icon mobile-maintenance-more" onclick="viewMaintenance(3)">
          <i class="fas fa-chevron-left"></i>
        </button>
      </div>
      
      <!-- مهمة صيانة -->
      <div class="mobile-maintenance-item">
        <div class="mobile-maintenance-status completed">منجزة</div>
        <div class="mobile-maintenance-content">
          <div class="mobile-maintenance-title">صيانة نظام التبريد</div>
          <div class="mobile-maintenance-vehicle">تويوتا كامري - أ ب ج ١٢٣٤</div>
          <div class="mobile-maintenance-meta">
            <span><i class="fas fa-calendar"></i> ٥ أبريل ٢٠٢٥</span>
            <span><i class="fas fa-user"></i> فني: أحمد محمد</span>
          </div>
        </div>
        <button class="mobile-btn-icon mobile-maintenance-more" onclick="viewMaintenance(4)">
          <i class="fas fa-chevron-left"></i>
        </button>
      </div>
      
      <!-- مهمة صيانة -->
      <div class="mobile-maintenance-item">
        <div class="mobile-maintenance-status completed">منجزة</div>
        <div class="mobile-maintenance-content">
          <div class="mobile-maintenance-title">فحص وتنظيف دورة الوقود</div>
          <div class="mobile-maintenance-vehicle">هونداي سوناتا - س ع د ٥٦٧٨</div>
          <div class="mobile-maintenance-meta">
            <span><i class="fas fa-calendar"></i> ١ أبريل ٢٠٢٥</span>
            <span><i class="fas fa-user"></i> فني: ماجد سعيد</span>
          </div>
        </div>
        <button class="mobile-btn-icon mobile-maintenance-more" onclick="viewMaintenance(5)">
          <i class="fas fa-chevron-left"></i>
        </button>
      </div>
    </div>
  </div>
  
  <!-- زر إضافة صيانة جديدة -->
  <button class="mobile-fab" onclick="location.href='{{ url_for('mobile.add_maintenance') }}'">
    <i class="fas fa-plus"></i>
  </button>
</div>
{% endblock %}

{% block styles %}
<style>
  .mobile-maintenance-list {
    padding: 0;
  }
  
  .mobile-maintenance-item {
    position: relative;
    padding: 16px;
    border-bottom: 1px solid var(--border-light);
    transition: background-color var(--transition-normal);
  }
  
  .mobile-maintenance-item.active {
    background-color: rgba(var(--primary-rgb), 0.05);
  }
  
  .mobile-maintenance-status {
    display: inline-block;
    padding: 4px 8px;
    border-radius: var(--border-radius-sm);
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-medium);
    margin-bottom: 8px;
  }
  
  .mobile-maintenance-status.scheduled {
    background-color: rgba(var(--primary-rgb), 0.1);
    color: var(--primary-color);
  }
  
  .mobile-maintenance-status.ongoing {
    background-color: rgba(var(--info-rgb), 0.1);
    color: var(--info-color);
  }
  
  .mobile-maintenance-status.completed {
    background-color: rgba(var(--success-rgb), 0.1);
    color: var(--success-color);
  }
  
  .mobile-maintenance-status.late {
    background-color: rgba(var(--danger-rgb), 0.1);
    color: var(--danger-color);
  }
  
  .mobile-maintenance-title {
    font-weight: var(--font-weight-medium);
    margin-bottom: 4px;
  }
  
  .mobile-maintenance-vehicle {
    font-size: var(--font-size-sm);
    color: var(--text-secondary);
    margin-bottom: 8px;
  }
  
  .mobile-maintenance-meta {
    display: flex;
    gap: 16px;
    font-size: var(--font-size-xs);
    color: var(--text-muted);
  }
  
  .mobile-maintenance-meta span {
    display: flex;
    align-items: center;
    gap: 4px;
  }
  
  .mobile-maintenance-more {
    position: absolute;
    top: 50%;
    left: 16px;
    transform: translateY(-50%);
  }
</style>
{% endblock %}

{% block scripts %}
<script>
  function toggleFilters() {
    const filtersSection = document.getElementById('filtersSection');
    if (filtersSection.style.display === 'none') {
      filtersSection.style.display = 'block';
    } else {
      filtersSection.style.display = 'none';
    }
  }
  
  function applyFilters() {
    // تنفيذ عملية الفلترة
    alert('تم تطبيق الفلتر');
    toggleFilters();
  }
  
  function viewMaintenance(id) {
    // انتقال إلى صفحة تفاصيل الصيانة - حاليًا نعود لصفحة السيارات الرئيسية
    location.href = '{{ url_for("mobile.vehicles") }}';
  }
</script>
{% endblock %}