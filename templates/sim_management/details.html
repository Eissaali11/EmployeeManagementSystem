{% extends "layout.html" %}

{% block title %}تفاصيل رقم SIM - {{ sim.phone_number }}{% endblock %}

{% block content %}
<style>
    body {
        background: #f8f9fa;
        min-height: 100vh;
        font-family: 'Tajawal', 'Cairo', sans-serif;
    }

    .main-container {
        background: white;
        border-radius: 15px;
        padding: 30px;
        margin: 20px auto;
        max-width: 1000px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        border: 1px solid #e9ecef;
    }

    .detail-card {
        background: white;
        border-radius: 12px;
        padding: 25px;
        margin-bottom: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        border: 1px solid #e9ecef;
    }

    .detail-card .card-header {
        background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
        color: white;
        border-radius: 8px;
        padding: 15px 20px;
        margin: -25px -25px 20px -25px;
        font-weight: 600;
        font-size: 1.1em;
        text-align: center;
    }

    .detail-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px 0;
        border-bottom: 1px solid #f1f3f4;
    }

    .detail-row:last-child {
        border-bottom: none;
    }

    .detail-label {
        font-weight: 600;
        color: #495057;
        min-width: 200px;
        font-size: 1.05em;
        display: flex;
        align-items: center;
    }

    .detail-value {
        flex: 1;
        text-align: left;
        font-weight: 500;
        color: #212529;
        font-size: 1.1em;
    }

    .status-badge {
        padding: 8px 16px;
        border-radius: 6px;
        font-size: 0.9em;
        font-weight: 600;
        text-align: center;
        display: inline-flex;
        align-items: center;
        gap: 5px;
    }

    .status-available {
        background: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
    }

    .status-assigned {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
    }

    .status-device-assigned {
        background: #fff3cd;
        color: #856404;
        border: 1px solid #ffeaa7;
    }

    .carrier-badge {
        padding: 8px 16px;
        border-radius: 6px;
        font-size: 0.9em;
        font-weight: 600;
        text-align: center;
        display: inline-block;
    }

    .carrier-stc {
        background: #e3f2fd;
        color: #1565c0;
        border: 1px solid #bbdefb;
    }

    .carrier-mobily {
        background: #e8f5e8;
        color: #2e7d32;
        border: 1px solid #c8e6c9;
    }

    .carrier-zain {
        background: #f3e5f5;
        color: #7b1fa2;
        border: 1px solid #e1bee7;
    }

    .page-header {
        background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
        color: white;
        padding: 25px;
        border-radius: 12px;
        margin-bottom: 25px;
        text-align: center;
        box-shadow: 0 3px 15px rgba(0, 123, 255, 0.2);
    }

    .page-header h1 {
        margin: 0;
        font-size: 2em;
        font-weight: 600;
    }

    .btn-back {
        background: #6c757d;
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 8px;
        font-weight: 500;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 20px;
        transition: all 0.2s ease;
    }

    .btn-back:hover {
        background: #5a6268;
        color: white;
        text-decoration: none;
    }

    .info-icon {
        margin-left: 8px;
        color: #007bff;
        min-width: 20px;
    }

    .empty-state {
        text-align: center;
        padding: 40px 20px;
        color: #6c757d;
    }

    .empty-state i {
        font-size: 3em;
        margin-bottom: 15px;
        color: #dee2e6;
    }

    .highlight-card {
        background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
        color: white;
        text-align: center;
        padding: 30px;
        border-radius: 12px;
        margin-bottom: 25px;
    }

    .phone-number {
        font-size: 2.5em;
        font-weight: 700;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }
</style>

<div class="main-container">
    <!-- زر العودة -->
    <a href="{{ url_for('sim_management.index') }}" class="btn-back">
        <i class="fas fa-arrow-right"></i>
        العودة لقائمة أرقام SIM
    </a>

    <!-- بطاقة رقم الهاتف المميزة -->
    <div class="highlight-card">
        <div class="phone-number">{{ sim.phone_number }}</div>
        <p class="mb-0">معلومات مفصلة لرقم SIM</p>
    </div>

    <!-- معلومات أساسية -->
    <div class="detail-card">
        <div class="card-header">
            <i class="fas fa-sim-card"></i>
            المعلومات الأساسية
        </div>
        
        <div class="detail-row">
            <span class="detail-label">
                <i class="fas fa-phone info-icon"></i>
                رقم الهاتف:
            </span>
            <span class="detail-value">{{ sim.phone_number }}</span>
        </div>
        
        <div class="detail-row">
            <span class="detail-label">
                <i class="fas fa-broadcast-tower info-icon"></i>
                الشبكة:
            </span>
            <span class="detail-value">
                <span class="carrier-badge carrier-{{ sim.carrier.lower().replace(' ', '') if sim.carrier else 'unknown' }}">
                    {{ sim.carrier or 'غير محدد' }}
                </span>
            </span>
        </div>
        
        <div class="detail-row">
            <span class="detail-label">
                <i class="fas fa-info-circle info-icon"></i>
                الحالة:
            </span>
            <span class="detail-value">
                {% if sim.employee_id %}
                    <span class="status-badge status-assigned">
                        <i class="fas fa-user"></i> مربوط بموظف
                    </span>
                {% elif sim.is_device_assigned %}
                    <span class="status-badge status-device-assigned">
                        <i class="fas fa-mobile-alt"></i> مربوط بجهاز
                    </span>
                {% else %}
                    <span class="status-badge status-available">
                        <i class="fas fa-check-circle"></i> متاح
                    </span>
                {% endif %}
            </span>
        </div>
        
        <div class="detail-row">
            <span class="detail-label">
                <i class="fas fa-calendar-plus info-icon"></i>
                تاريخ الإنشاء:
            </span>
            <span class="detail-value">
                {{ sim.created_at.strftime('%Y-%m-%d %H:%M') if sim.created_at else 'غير محدد' }}
            </span>
        </div>
    </div>

    <!-- معلومات الموظف -->
    {% if employee %}
    <div class="detail-card">
        <div class="card-header">
            <i class="fas fa-user"></i>
            معلومات الموظف المربوط
        </div>
        
        <div class="detail-row">
            <span class="detail-label">
                <i class="fas fa-user info-icon"></i>
                اسم الموظف:
            </span>
            <span class="detail-value">{{ employee.name }}</span>
        </div>
        
        <div class="detail-row">
            <span class="detail-label">
                <i class="fas fa-id-badge info-icon"></i>
                رقم الموظف:
            </span>
            <span class="detail-value">{{ employee.employee_id }}</span>
        </div>
        
        {% if employee.national_id %}
        <div class="detail-row">
            <span class="detail-label">
                <i class="fas fa-id-card info-icon"></i>
                رقم الهوية:
            </span>
            <span class="detail-value">{{ employee.national_id }}</span>
        </div>
        {% endif %}
        
        {% if employee.departments %}
        <div class="detail-row">
            <span class="detail-label">
                <i class="fas fa-building info-icon"></i>
                القسم:
            </span>
            <span class="detail-value">
                {% for dept in employee.departments %}
                    <span class="badge bg-primary me-1">{{ dept.name }}</span>
                {% endfor %}
            </span>
        </div>
        {% endif %}
        
        {% if employee.city %}
        <div class="detail-row">
            <span class="detail-label">
                <i class="fas fa-map-marker-alt info-icon"></i>
                المدينة:
            </span>
            <span class="detail-value">{{ employee.city }}</span>
        </div>
        {% endif %}
    </div>
    {% endif %}

    <!-- معلومات الجهاز -->
    {% if device %}
    <div class="detail-card">
        <div class="card-header">
            <i class="fas fa-mobile-alt"></i>
            معلومات الجهاز المربوط
        </div>
        
        <div class="detail-row">
            <span class="detail-label">
                <i class="fas fa-hashtag info-icon"></i>
                رقم الجهاز:
            </span>
            <span class="detail-value">{{ device.device_number }}</span>
        </div>
        
        <div class="detail-row">
            <span class="detail-label">
                <i class="fas fa-tag info-icon"></i>
                نوع الجهاز:
            </span>
            <span class="detail-value">{{ device.device_type or 'غير محدد' }}</span>
        </div>
        
        <div class="detail-row">
            <span class="detail-label">
                <i class="fas fa-copyright info-icon"></i>
                العلامة التجارية:
            </span>
            <span class="detail-value">{{ device.brand or 'غير محدد' }}</span>
        </div>
        
        <div class="detail-row">
            <span class="detail-label">
                <i class="fas fa-mobile-alt info-icon"></i>
                الموديل:
            </span>
            <span class="detail-value">{{ device.model or 'غير محدد' }}</span>
        </div>
    </div>
    {% endif %}

    <!-- معلومات الربط -->
    {% if device_assignment %}
    <div class="detail-card">
        <div class="card-header">
            <i class="fas fa-link"></i>
            تفاصيل الربط في النظام
        </div>
        
        <div class="detail-row">
            <span class="detail-label">
                <i class="fas fa-calendar info-icon"></i>
                تاريخ الربط:
            </span>
            <span class="detail-value">
                {{ device_assignment.assignment_date.strftime('%Y-%m-%d %H:%M') if device_assignment.assignment_date else 'غير محدد' }}
            </span>
        </div>
        
        <div class="detail-row">
            <span class="detail-label">
                <i class="fas fa-tasks info-icon"></i>
                نوع الربط:
            </span>
            <span class="detail-value">
                {% if device_assignment.assignment_type == 'device_only' %}
                    جهاز فقط
                {% elif device_assignment.assignment_type == 'sim_only' %}
                    SIM فقط
                {% elif device_assignment.assignment_type == 'device_and_sim' %}
                    جهاز + SIM
                {% else %}
                    {{ device_assignment.assignment_type }}
                {% endif %}
            </span>
        </div>
        
        <div class="detail-row">
            <span class="detail-label">
                <i class="fas fa-toggle-on info-icon"></i>
                الحالة:
            </span>
            <span class="detail-value">
                {% if device_assignment.is_active %}
                    <span class="status-badge status-available">
                        <i class="fas fa-check-circle"></i> نشط
                    </span>
                {% else %}
                    <span class="status-badge status-assigned">
                        <i class="fas fa-times-circle"></i> غير نشط
                    </span>
                {% endif %}
            </span>
        </div>
        
        {% if device_assignment.notes %}
        <div class="detail-row">
            <span class="detail-label">
                <i class="fas fa-sticky-note info-icon"></i>
                ملاحظات:
            </span>
            <span class="detail-value">{{ device_assignment.notes }}</span>
        </div>
        {% endif %}
    </div>
    {% endif %}

    <!-- رسالة عندما لا توجد ربطات -->
    {% if not employee and not device and not device_assignment %}
    <div class="detail-card">
        <div class="empty-state">
            <i class="fas fa-unlink"></i>
            <h5>لا توجد ربطات نشطة</h5>
            <p>هذا الرقم غير مربوط بأي موظف أو جهاز حالياً</p>
        </div>
    </div>
    {% endif %}
</div>

{% endblock %}