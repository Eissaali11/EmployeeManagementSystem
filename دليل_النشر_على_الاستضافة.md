# دليل النشر الشامل لنظام إدارة الموظفين

## معلومات المشروع
- **اسم المشروع**: نظام إدارة الموظفين
- **تاريخ الإصدار**: أبريل 2025
- **المطور**: فريق التطوير - شركة التقنية المتطورة

## ١. تحضير ملفات النشر

### الطريقة أ: تنزيل المشروع واستخدام سكريبت الضغط

1. **تنزيل المشروع بالكامل**:
   - انقر على اسم المشروع في الزاوية العلوية اليسرى من Replit
   - اختر "Download as ZIP" من القائمة المنسدلة
   - استخرج الملفات إلى مجلد على جهازك المحلي

2. **إنشاء ملف مضغوط للنشر**:
   - افتح موجه الأوامر (Command Prompt) أو Terminal على جهازك
   - انتقل إلى مجلد المشروع المستخرج
   - نفذ الأمر التالي:
     ```
     python create_deployment_zip.py
     ```
   - سيتم إنشاء ملف مضغوط يحتوي على جميع الملفات اللازمة للنشر

### الطريقة ب: إنشاء مجلد للنشر يدويًا

1. **إنشاء مجلد جديد**:
   - أنشئ مجلد جديد باسم "employee_system_deploy"

2. **نسخ الملفات الضرورية**:
   
   #### الملفات الأساسية:
   - main.py
   - app.py
   - models.py
   - wsgi.py (تم تحديثه للتوافق مع الاستضافة المشتركة)
   - index.php (بوابة الدخول للتطبيق)
   - .htaccess (تم تكوينه لحل مشكلات الأذونات)
   - php.ini (إعدادات PHP)
   - setup.py
   
   #### ملفات التكوين:
   - requirements_deploy.txt (سيتم تغيير اسمه لاحقًا)
   - .env.example (سيتم تغيير اسمه لاحقًا)
   
   #### المجلدات الرئيسية:
   - static/ (الصور، CSS، JavaScript)
   - templates/ (قوالب HTML)
   - routes/ (مسارات التطبيق)
   - utils/ (أدوات مساعدة)
   
   #### ملفات المساعدة:
   - check_installation.py
   - deploy_guide.md
   - domain_deployment.md
   - deployment_instructions.txt

3. **ضغط المجلد**:
   - اضغط المجلد بتنسيق ZIP

## ٢. تجهيز الاستضافة على Hostinger

### إعداد قاعدة البيانات

1. **إنشاء قاعدة بيانات PostgreSQL**:
   - سجل دخولك إلى لوحة تحكم Hostinger
   - انتقل إلى قسم "Databases" أو "قواعد البيانات"
   - اختر "PostgreSQL Databases"
   - انقر على "Create New Database"
   - أدخل اسم قاعدة البيانات واسم المستخدم وكلمة المرور
   - احتفظ بهذه المعلومات لاستخدامها لاحقًا

2. **الحصول على بيانات الاتصال**:
   - اسم قاعدة البيانات (مثال: `db_employees`)
   - اسم المستخدم (مثال: `dbuser`)
   - كلمة المرور (مثال: `P@ssw0rd!`)
   - المضيف/الخادم (عادة: `localhost`)
   - المنفذ (عادة: `5432`)

### إعداد النطاق (الدومين)

1. **تكوين النطاق**:
   - انتقل إلى قسم "Domains" أو "النطاقات"
   - تأكد من أن النطاق مرتبط بحزمة الاستضافة
   - تأكد من أن سجلات DNS تشير إلى خوادم Hostinger

## ٣. رفع الملفات إلى الخادم

### رفع الملفات باستخدام مدير الملفات

1. **الوصول إلى مدير الملفات**:
   - انتقل إلى لوحة تحكم Hostinger
   - اختر "File Manager" أو "مدير الملفات"

2. **تحديد المجلد الهدف**:
   - انتقل إلى المجلد الجذر للموقع (عادة `public_html`)

3. **رفع واستخراج الملفات**:
   - انقر على زر "Upload" أو "رفع"
   - حدد ملف ZIP الذي قمت بإنشائه
   - بعد الرفع، استخرج الملفات إلى المجلد الجذر

### رفع الملفات باستخدام FTP

1. **الحصول على بيانات FTP**:
   - انتقل إلى قسم "FTP Accounts" في لوحة تحكم Hostinger
   - اعرض بيانات FTP (الخادم، اسم المستخدم، كلمة المرور، المنفذ)

2. **استخدام برنامج FTP**:
   - استخدم برنامج مثل FileZilla أو WinSCP
   - ادخل بيانات الاتصال
   - انتقل إلى المجلد الجذر على الخادم
   - ارفع جميع الملفات من المجلد المحلي

## ٤. تكوين النظام بعد الرفع

1. **إعادة تسمية الملفات**:
   - قم بتغيير اسم `requirements_deploy.txt` إلى `requirements.txt`
   - قم بتغيير اسم `.env.example` إلى `.env`

2. **تحرير ملف .env**:
   - افتح ملف `.env` للتحرير
   - أضف بيانات الاتصال بقاعدة البيانات:
     ```
     DATABASE_URL=postgresql://dbuser:P@ssw0rd!@localhost:5432/db_employees
     SECRET_KEY=مفتاح_سري_عشوائي_طويل
     FLASK_ENV=production
     ```
   - أضف بيانات Twilio إذا كانت متوفرة

3. **تعديل أذونات الملفات**:
   - حدد جميع الملفات واضبط الأذونات على `644`
   - حدد جميع المجلدات واضبط الأذونات على `755`
   - حدد الملفات التنفيذية (مثل *.py) واضبط الأذونات على `755`

4. **تهيئة قاعدة البيانات**:
   - إذا كان SSH متاحًا، اتصل بالخادم ونفذ:
     ```
     python setup.py
     ```
   - إذا لم يكن SSH متاحًا، قم بزيارة:
     ```
     https://yourdomain.com/static/deploy/setup.php
     ```

## ٥. حل مشكلة خطأ 403 (الوصول ممنوع)

إذا واجهت خطأ 403 بعد رفع الملفات، جرب الإجراءات التالية:

### التحقق من ملف .htaccess

1. **تأكد من وجود ملف .htaccess**:
   - افتح مدير الملفات وتأكد من وجود ملف `.htaccess` في المجلد الجذر
   - تأكد من أن محتوى الملف يطابق الملف الذي قمت برفعه

2. **تحرير ملف .htaccess**:
   - قد تحتاج إلى تعديل المسارات حسب إعدادات الخادم الخاص بك
   - تأكد من تحديث المسار في قسم `<Directory>` ليعكس المسار الفعلي على خادمك:
     ```
     <Directory "/path/to/your/actual/public_html">
         Options Indexes FollowSymLinks
         AllowOverride All
         Require all granted
     </Directory>
     ```

### التحقق من أذونات الملفات

1. **ضبط الأذونات الصحيحة**:
   - الملفات العادية: `644`
   - المجلدات: `755`
   - الملفات التنفيذية (Python): `755`
   - ملفات التكوين الحساسة مثل `.env`: `600`

2. **تغيير ملكية الملفات**:
   - إذا كان لديك وصول SSH، يمكنك تنفيذ:
     ```
     chown -R yourusername:yourgroup /path/to/public_html
     ```

### التحقق من تكوين PHP و Python

1. **تأكد من دعم PHP لـ Python**:
   - افتح لوحة تحكم Hostinger
   - تحقق من إصدارات PHP و Python المدعومة
   - تأكد من تمكين وحدات Python اللازمة

2. **إنشاء ملف phpinfo.php للتشخيص**:
   - أنشئ ملف `phpinfo.php` في المجلد الجذر بالمحتوى التالي:
     ```php
     <?php phpinfo(); ?>
     ```
   - افتح `yourdomain.com/phpinfo.php` للتحقق من إعدادات PHP

### الاتصال بدعم Hostinger

إذا استمرت المشكلة بعد محاولة الحلول أعلاه:

1. **جمع معلومات الخطأ**:
   - رسالة الخطأ الدقيقة
   - محتوى ملف `.htaccess`
   - إعدادات أذونات الملفات الرئيسية
   - سجلات الخطأ من لوحة تحكم Hostinger

2. **الاتصال بالدعم الفني**:
   - قدم المعلومات التي جمعتها
   - اطلب مساعدة خاصة بتكوين تطبيق Python/Flask على استضافتهم

## ٦. اختبار النظام بعد النشر

1. **زيارة الموقع**:
   - افتح متصفح ويب
   - انتقل إلى عنوان دومينك: `https://yourdomain.com`

2. **تسجيل الدخول**:
   - استخدم بيانات المسؤول الافتراضية:
     - البريد الإلكتروني: `admin@example.com`
     - كلمة المرور: `admin123`
   - بعد تسجيل الدخول، غيّر كلمة المرور الافتراضية فورًا

3. **التحقق من وظائف النظام**:
   - تأكد من أن جميع الصفحات تعمل
   - تحقق من عمليات قاعدة البيانات (إضافة/تعديل/حذف)
   - تحقق من صحة عرض البيانات والتقارير

## ٧. الصيانة والتحديثات

1. **النسخ الاحتياطي**:
   - قم بإعداد نسخ احتياطي منتظم لقاعدة البيانات
   - احتفظ بنسخة من ملفات الموقع

2. **التحديثات**:
   - تحقق من تحديثات الأمان لحزم Python المستخدمة
   - قم بتحديث النظام عند توفر إصدارات جديدة

3. **المراقبة**:
   - راقب أداء الموقع وسجلات الخطأ
   - تحقق من استجابة الموقع بانتظام

---

## ملاحظات إضافية

- استخدم HTTPS لتأمين اتصال الموقع (يمكن تفعيله من لوحة تحكم Hostinger)
- تأكد من إعداد جدار حماية مناسب لحماية بيانات الموظفين
- قم بإنشاء حسابات منفصلة للمستخدمين بأدوار مختلفة (مدير، موظف، إلخ)
- احتفظ بنسخة محلية من قاعدة البيانات والملفات للطوارئ

---

## الدعم الفني

إذا واجهتك أي مشكلة أثناء عملية النشر أو بعدها، يمكنك:

1. مراجعة ملفات الدليل المرفقة:
   - `deploy_guide.md`
   - `domain_deployment.md`
   - `check_installation.py`

2. الاتصال بفريق الدعم الفني لـ Hostinger

3. مراجعة مستندات Flask و PostgreSQL لحل المشكلات التقنية